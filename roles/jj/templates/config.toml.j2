# JJ Configuration File
# Generated by Ansible dotfiles role

[user]
name = "{{ git_user_name }}"
email = "{{ jj_user_email }}"

[ui]
# Default command when no subcommand is specified
default-command = "log"

# Color output settings
color = "auto"

# Conflict marker style
conflict-marker-style = "diff"

# Show relative timestamps
relative-timestamps = true

[git]
# Automatic local bookmark creation
auto-local-bookmark = true

# Default remotes for fetch and push
default-push-remote = "origin"
default-fetch-remote = "origin"

[signing]
# Enable signing for all commits
behavior = "own"
# Use SSH signing (matching Git configuration)
backend = "ssh"
# SSH key for signing
key = "{{ ansible_user_dir }}/.ssh/id_ed25519.pub"

[templates]
# Customize log output format
log = '''
if(root,
  format_root_commit(self),
  label(if(current_working_copy, "working_copy"),
    concat(
      separate(" ",
        format_short_change_id_with_hidden_and_divergent_info(self),
        if(author.email(), author.name(), email_placeholder),
        committer.timestamp().format("%Y-%m-%d %H:%M") ++ " " ++ label("timestamp_ago", "(" ++ committer.timestamp().ago() ++ ")"),
        bookmarks,
        tags,
        working_copies,
        git_refs,
        format_short_commit_id(commit_id),
        if(conflict, label("conflict", "conflict")),
        if(empty, label("empty", "(empty)")),
        if(description,
          description.first_line(),
          description_placeholder
        ),
      ) ++ "\n",
    )
  )
)
'''

[revset-aliases]
# Customize immutable commits to include main branch
"immutable_heads()" = "builtin_immutable_heads() | main@origin"

[colors]
# Color scheme matching common Git configurations
"commit_id" = "blue"
"change_id" = "magenta"
"author" = "yellow"
"committer" = "cyan"
"working_copy" = { fg = "green", bold = true }
"branch" = "yellow"
"tag" = { fg = "red", bold = true }
"git_refs" = "green"
"conflict" = { fg = "red", bold = true }
"empty" = "green"
"timestamp_ago" = "bright black"
